# ğŸ¬ Movie Recommender â€“ Matrix Factorization Baseline

## Overview

This module implements a **collaborative filtering recommender system** based on Matrix Factorization.

It learns user and movie representations (â€œembeddingsâ€) from historical rating data and uses them to generate movie recommendations.

The system supports:

- Training on explicit rating data  
-  Top-N recommendations for known users  
-  Cold-start recommendations for new users (based on a few ratings)  
-  Saving and loading trained models  

This is designed as a **clean, scalable baseline model** for a multi-model recommender system.

---

## How It Works (Intuition)

Instead of manually defining genres or rules, the model learns patterns directly from user ratings.

- Each **movie** is represented as a vector in a learned â€œpreference spaceâ€.
- Each **user** is represented as a vector in the same space.
- Movies that are often liked by similar users end up close to each other.
- Recommendations are generated by finding movies that are closest to a user's preferences in this space.

For new users (cold-start), we build a temporary user profile from a few rated movies and recommend similar ones.

---

## Project Structure

Example structure:

```
PROJECT-ROOT/
â”‚
â”œâ”€â”€ data/
â”‚   â””â”€â”€ processed/
â”‚       â”œâ”€â”€ train.csv
â”‚       â”œâ”€â”€ val.csv
â”‚       â””â”€â”€ items.csv
â”‚
â”œâ”€â”€ models/
â”‚   â””â”€â”€ mf/
â”‚        data.py
â”‚        model.py
â”‚        mf_model.pt
â”‚        service.py
â”‚
â””â”€â”€ README.md
```
- data.py: Data loading and preprocessing utilities.
- model.py : Actual Matrix Factorization pytorch model.
- service.py : Functions for generating recommendations and handling cold-start.
  - *** best entry point for external use (e.g., API calls) ***
- mf_model.pt : Example of a saved trained model.
---

## Data Requirements

### Training Data (`train.csv`, `val.csv`)

Expected columns:

| column     | type    | description                     |
|------------|---------|---------------------------------|
| user_idx   | int     | sequential user index           |
| item_idx   | int     | sequential movie index          |
| rating     | float   | explicit rating (e.g., 0.5â€“5.0) |

These indices must be contiguous integers starting from 0 (required for embedding layers).

---

### Movie Metadata (`items.csv`)

Expected columns:

| column     | description                           |
|------------|---------------------------------------|
| item_idx   | internal movie index                  |
| movieId    | original MovieLens movie ID           |
| title      | movie title                           |

This file is used to map internal indices back to real movie IDs and titles.

---

## Installation

Make sure you have:

- Python 3.9+
- PyTorch
- pandas
- numpy

Example:

```bash
pip install torch pandas numpy
```

---

## Training the Model

```python
import pandas as pd
from models.collaborative_model import CollaborativeModel

train_df = pd.read_csv("data/processed/train.csv")
val_df = pd.read_csv("data/processed/val.csv")
items_df = pd.read_csv("data/processed/items.csv")

model = CollaborativeModel(
    latent_dim=20,
    lr=1e-3,
    weight_decay=1e-5,
    movie_data=items_df
)

model.fit(train_df, epochs=10, batch_size=2048, val_df=val_df)
model.save("mf_model.pt")
```

---

## Loading a Trained Model

```python
model = CollaborativeModel.load(
    "mf_model.pt",
    movie_data=items_df
)
```

---

## Cold-Start Recommendations (New Users)

You can generate recommendations for a new user by providing a small set of ratings:
You an also find a usage example in service.py in main()
```python
recs = model.recommend_from_ratings(
    ratings=[
            (4993, 5.0),  # LOTR
            (5816, 5.0),  # Harry Potter 2
            (1721, 1.0),  # Titanic
    ],
    top_n=10,
    return_scores=True
)

for movie_id, score in recs:
    print(movie_id, model.get_movie_title(movie_id), score)
```

### What Happens Internally

- The system builds a temporary user profile based on the rated movies.
- Highly rated movies pull the profile in their direction.
- Low-rated movies push it away.
- The model recommends movies that best match this generated profile.

No retraining is required for new users.

---

## Design Decisions

- Uses **Matrix Factorization** with learned embeddings.
- Optimized with Mean Squared Error (MSE) on observed ratings.
- Supports bias terms for users and items.
- Cold-start handled via embedding aggregation (no re-training).

---

## Limitations

- Only movies seen during training can be recommended.
- Unknown movie IDs in cold-start input are ignored.
- No explainability layer (yet).
- Cold-start quality improves with more ratings.

---

## Possible Extensions

- Hybrid model (combine content-based + CF)
- Ranking-based loss instead of MSE
- Popularity fallback for extreme cold-start
- Add explainability (â€œBecause you likedâ€¦â€)
- API endpoint for production deployment

---

## Author / Context

This model serves as a collaborative filtering baseline within a multi-model movie recommendation system.

It is intentionally kept simple, modular, and extensible.